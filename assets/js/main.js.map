{"mappings":"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","sources":["src/helpers.js","src/dropDown.js","src/marker.js","src/shadowDropDown.js","src/shadowMarker.js","src/menu.js","src/designNotesMain.js","src/index.js"],"sourcesContent":["export function on(event, callback, element = document){\r\n    return element.addEventListener(event,callback);\r\n}\r\nexport function off(event, callback, element = document){\r\n    return element.removeEventListener(event,callback);\r\n}\r\nexport function select(selector,element = document,all = false){\r\n    return (all ? element.querySelectorAll(selector) : element.querySelector(selector));\r\n}\r\nexport function createElement(tag,args = {},content){\r\n    const e = { \r\n        tag : tag || 'div',\r\n        class : args.class || '',\r\n        content : content || '',\r\n        attributes : '',\r\n    }\r\n    if(args.attributes){\r\n        let attributes = '';\r\n        args.attributes.forEach(item=>{\r\n            attributes += ` ${item.name}=\"${item.value}\"`;\r\n        });\r\n        e.attributes = attributes;\r\n    }\r\n\r\n    if(e.class){\r\n        e.class = ` class=\"${e.class}\"`; \r\n    }\r\n    \r\n    return `<${e.tag}${e.class}${e.attributes}>${e.content}</${e.tag}>`;\r\n}\r\nexport function renderElement(element, parent, position = 'beforeend'){\r\n    let property = 'lastElementChild';\r\n    switch (position) {\r\n        case 'beforebegin':\r\n            property = 'previousElementSibling';\r\n            break;\r\n        case 'afterbegin':\r\n            property = 'firstElementChild';\r\n            break;\r\n        case 'beforebegin':\r\n            property = 'previousElementSibling';\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    parent.insertAdjacentHTML(position, element);\r\n    return parent[property];\r\n}\r\n\r\n\r\n\r\n  \r\n\r\n","import { on } from \"./helpers\";\r\n\r\n\r\nexport default function DropDown(marker, element){\r\n    const self = {\r\n        element: element,\r\n        marker: marker,\r\n        active: false,\r\n        textArea: null,\r\n        is_ajaxing: false,\r\n        mensions: [],\r\n        openClose(){\r\n            if(self.active){\r\n                self.close()\r\n            }else{\r\n                self.open()\r\n            }\r\n        },\r\n        open(){\r\n            window[Symbol.for('diviDesignNotesAPI')].closeDropdowns();\r\n            self.element.classList.add('open');\r\n            self.active = true;\r\n            self.setPosition()\r\n        },\r\n        close(){\r\n            self.element.classList.remove('open');\r\n            self.active = false;\r\n        },\r\n        checkMensions(string){\r\n            self.mensions = [];\r\n            let stringMensions = string;\r\n            window[Symbol.for('diviDesignNotesAPI')].data.users.forEach(user=>{\r\n                if(string.includes(`@${user.display_name}`)){\r\n                    stringMensions = stringMensions.replace(`@${user.display_name}`,`<span>@${user.display_name}</span>`);\r\n                  \r\n                    if(!self.mensions.indexOf(user.user_email)+1){\r\n                        self.mensions.push(user.user_email);\r\n                    }\r\n                }\r\n            })\r\n            return stringMensions;\r\n        },\r\n        setPosition(){\r\n            if(!self.active) return;\r\n            const rects = self.marker.element.getBoundingClientRect();\r\n            const fromLeft = rects.x < 175 ? 1 : 0;\r\n            const fromRight = ((innerWidth - rects.right) < 175) ? 3 : 0;\r\n            const fromBottom = ((innerHeight - rects.bottom) < 200) ? 5 : 0;\r\n            let translate = '';\r\n\r\n            if(fromBottom || fromRight || fromLeft){\r\n                switch(fromBottom + fromLeft + fromRight) {\r\n                    case 1: //Left\r\n                    case 4: //Left & Right\r\n                        translate = `translateX(-${rects.x}px)`\r\n                        break;\r\n                    case 3: //Right\r\n                        translate = `translateX(-${350-(innerWidth - rects.right)}px)`\r\n                        break;\r\n                    case 5: //Bottom\r\n                        translate = `translate(-50%,-100%) translate(15px,-40px)`\r\n                        break;\r\n                    case 6: //Left & Bottom\r\n                        translate = `translate(-${rects.x}px,-100%) translateY(-40px)`\r\n                        break;\r\n                    case 8: //Right & Bottom\r\n                        translate = `translate(-${350-(innerWidth - rects.right)}px,-100%) translateY(-40px)`\r\n                        break;\r\n                    case 9: //Left & Right & Bottom\r\n                        translate = `translate(0,-100%) translateY(-40px)`\r\n                        break;\r\n                    }\r\n            }\r\n            \r\n            self.element.style.top = `${rects.bottom}px`;\r\n            self.element.style.left = `${rects.x}px`;\r\n            self.element.style.transform = translate;\r\n            if(!fromBottom){\r\n                self.element.style.maxHeight = `${innerHeight - rects.bottom}px`;\r\n            }else{\r\n                self.element.style.maxHeight = '';\r\n            }\r\n        },\r\n        clicked(e){\r\n            if(!e.target.dataset.action || self.is_ajaxing) return;\r\n            self.ajaxing(true);\r\n            if(e.target.dataset.action === 'cancel'){\r\n                self.close();\r\n                self.ajaxing(false);\r\n                return;\r\n            }\r\n            if(e.target.dataset.action === 'resolve'){\r\n                self.resolve();\r\n                return;\r\n            }\r\n            if(e.target.dataset.action === 'post'){\r\n                self.post();\r\n                return;\r\n            }\r\n            if(e.target.dataset.action === 'delete'){\r\n                self.delete();\r\n                return;\r\n            }\r\n        },\r\n        resolve(){\r\n            self.ajaxing(true);\r\n            const data = new FormData();\r\n            data.append('type', 'resolve')\r\n            data.append('id', self.marker.id)\r\n            window[Symbol.for('diviDesignNotesAPI')].ajax(data)\r\n            .then(res=>{if(res.ok)return res.json()})\r\n            .then(json => {\r\n                self.marker.element.classList.add('resolved')\r\n                self.element.classList.add('resolved')\r\n                self.ajaxing(false);\r\n            }).catch(err =>{self.ajaxing(false)});\r\n            \r\n        },\r\n        post(){\r\n            if(!self.textArea.value.trim()){\r\n                self.textArea.value = '';\r\n                return;\r\n            }\r\n            self.ajaxing(true);\r\n            const data = new FormData();\r\n            const content = self.checkMensions(self.textArea.value);\r\n\r\n            if(self.mensions.length){\r\n                data.append('mensions', self.mensions.join(','))\r\n            }\r\n            data.append('type', 'post')\r\n            data.append('parent_id', self.marker.id)\r\n            data.append('content', content.trim())\r\n            data.append('post_id', window[Symbol.for('diviDesignNotesAPI')].data.post_id)\r\n            data.append('href', window[Symbol.for('diviDesignNotesAPI')].data.href)\r\n            data.append('title', window[Symbol.for('diviDesignNotesAPI')].data.title)\r\n            window[Symbol.for('diviDesignNotesAPI')].ajax(data)\r\n            .then(res=>{if(res.ok)return res.json()})\r\n            .then(obj => {\r\n                if(obj.success){\r\n                    const body = self.element.querySelector('.design_note_dropdown_body')\r\n                    body.insertAdjacentHTML('beforeend',obj.html)\r\n                    self.textArea.value = '';\r\n                }\r\n                self.ajaxing(false);\r\n            }).catch(err =>{self.ajaxing(false)});\r\n        },\r\n        delete(){\r\n            self.ajaxing(true);\r\n            const data = new FormData();\r\n            data.append('type', 'delete')\r\n            data.append('note_id', self.marker.id)\r\n            window[Symbol.for('diviDesignNotesAPI')].ajax(data)\r\n            .then(res=>{if(res.ok)return res.json()})\r\n            .then(obj => {\r\n                if(obj.parent){\r\n                    window[Symbol.for('diviDesignNotesAPI')].delete(self.marker);\r\n                }else{\r\n                    self.ajaxing(false)\r\n                }\r\n            }).catch(err =>{self.ajaxing(false)});\r\n        },\r\n        ajaxing(flag = null){\r\n            if(flag === null){\r\n                return self.is_ajaxing;\r\n            }\r\n            if(flag){\r\n                self.element.classList.add('ajaxing');\r\n                self.is_ajaxing = true;\r\n            }\r\n            if(!flag){\r\n                self.element.classList.remove('ajaxing');\r\n                self.is_ajaxing = false;\r\n            }\r\n        },\r\n        init(){\r\n            self.textArea = self.element.querySelector('textarea');\r\n            document.body.appendChild(self.element);\r\n            on('click', self.clicked, self.element);\r\n        }\r\n\r\n        \r\n    };\r\n    self.init();\r\n    \r\n    return self;\r\n\r\n\r\n}","import DropDown from \"./dropDown\";\r\nimport { on, select } from \"./helpers\";\r\n\r\nexport default function Marker( element ){\r\n    const self = {\r\n        element: element,\r\n        id: element.id.split('-')[1],\r\n        data: JSON.parse(element.dataset.params),\r\n        relatedElement: 'null',\r\n        relativeToElement: false,\r\n        dropDown: null,\r\n        position: {\r\n            x:0,\r\n            y:0\r\n        },\r\n        getRelativity : function() {\r\n            self.relativeToElement = ['relative','absolute','fixed'].includes(getComputedStyle(self.relatedElement).position);\r\n            return self.relativeToElement;\r\n        },\r\n        setRelPosition: function(){\r\n            self.element.style.position = 'absolute';\r\n            self.element.style.top = `${(self.position.y/self.relatedElement.offsetHeight)*100}%`;\r\n            self.element.style.left = `${(self.position.x/self.relatedElement.offsetWidth)*100}%`;\r\n            self.element.style.transform = `translate(-20px,-40px)`;\r\n        },\r\n        setFixPosition: function(){\r\n            const rects = self.relatedElement.getBoundingClientRect();\r\n            self.element.style.transform = `translate3d(${self.position.x + rects.x}px,${self.position.y+rects.y}px,0)`;\r\n        },\r\n        setPosition: function(){\r\n            if(self.relativeToElement) return;\r\n            self.setFixPosition();\r\n        },\r\n        openClose: function(e){\r\n            self.dropDown.openClose(self.dropDown)\r\n        },\r\n        init: function() {\r\n            self.relatedElement = self.data.el ? select(self.data.el) : select('#page-container');\r\n            self.position = self.data.pos;\r\n            if(self.getRelativity()){\r\n                self.setRelPosition();\r\n                self.relatedElement.appendChild(self.element)\r\n            }else{\r\n                self.element.style.position = 'fixed';\r\n                self.setFixPosition();\r\n                document.body.appendChild(self.element)\r\n            }\r\n            self.dropDown = DropDown(self, select(`#notedropdown-${self.id}`));\r\n            on('click', self.openClose, self.element );\r\n            return self;\r\n\r\n        },\r\n\r\n\r\n    };\r\n    \r\n    return self;\r\n}","import { on } from \"./helpers\";\r\n\r\n\r\nexport default function shadowDropDown(marker, element){\r\n    const self = { \r\n        element: element,\r\n        marker: marker,\r\n        active: false,\r\n        textArea: null,\r\n        is_ajaxing: false,\r\n        mensions: [],\r\n        openClose:()=>{\r\n            if(self.active){\r\n                self.close()\r\n            }else{\r\n                self.open()\r\n            }\r\n        },\r\n        open: () =>{\r\n            window[Symbol.for('diviDesignNotesAPI')].closeDropdowns();\r\n            self.element.classList.add('open');\r\n            self.active = true;\r\n            self.setPosition()\r\n        },\r\n        close: () =>{\r\n            self.element.classList.remove('open');\r\n            self.active = false;\r\n        },\r\n        checkMensions(string){\r\n            self.mensions = [];\r\n            let stringMensions = string;\r\n            window[Symbol.for('diviDesignNotesAPI')].data.users.forEach(user=>{\r\n                if(string.includes(`@${user.display_name}`)){\r\n                    stringMensions = stringMensions.replace(`@${user.display_name}`,`<span>@${user.display_name}</span>`);\r\n                    if(!self.mensions.indexOf(user.user_email)+1){\r\n                        self.mensions.push(user.user_email);\r\n                    }\r\n                }\r\n            })\r\n            return stringMensions;\r\n        },\r\n        setPosition: ()=>{\r\n            if(!self.active) return;\r\n            const rects = self.marker.element.getBoundingClientRect();\r\n            const fromLeft = rects.x < 175 ? 1 : 0;\r\n            const fromRight = ((innerWidth - rects.right) < 175) ? 3 : 0;\r\n            const fromBottom = ((innerHeight - rects.bottom) < 200) ? 5 : 0;\r\n            let translate = '';\r\n\r\n            if(fromBottom || fromRight || fromLeft){\r\n                switch(fromBottom + fromLeft + fromRight) {\r\n                    case 1: //Left\r\n                    case 4: //Left & Right\r\n                        translate = `translateX(-${rects.x}px)`\r\n                        break;\r\n                    case 3: //Right\r\n                        translate = `translateX(-${350-(innerWidth - rects.right)}px)`\r\n                        break;\r\n                    case 5: //Bottom\r\n                        translate = `translate(-50%,-100%) translate(15px,-40px)`\r\n                        break;\r\n                    case 6: //Left & Bottom\r\n                        translate = `translate(-${rects.x}px,-100%) translateY(-40px)`\r\n                        break;\r\n                    case 8: //Right & Bottom\r\n                        translate = `translate(-${350-(innerWidth - rects.right)}px,-100%) translateY(-40px)`\r\n                        break;\r\n                    case 9: //Left & Right & Bottom\r\n                        translate = `translate(0,-100%) translateY(-40px)`\r\n                        break;\r\n                    }\r\n            }\r\n            \r\n            self.element.style.top = `${rects.bottom}px`;\r\n            self.element.style.left = `${rects.x}px`;\r\n            self.element.style.transform = translate;\r\n            if(!fromBottom){\r\n                self.element.style.maxHeight = `${innerHeight - rects.bottom}px`;\r\n            }else{\r\n                self.element.style.maxHeight = '';\r\n            }\r\n        },\r\n        clear(){\r\n            self.textArea.value = '';\r\n        },\r\n        clicked: (e)=>{\r\n            if(!e.target.dataset.action || self.is_ajaxing) return;\r\n            self.ajaxing(true);\r\n            if(e.target.dataset.action === 'cancel'){\r\n                self.clear();\r\n                self.marker.reset();\r\n                self.ajaxing(false);\r\n            }\r\n            if(e.target.dataset.action === 'create'){\r\n                self.create();\r\n                return;\r\n            }\r\n        },\r\n        create:()=>{\r\n            if(!self.textArea.value.trim()){\r\n                self.textArea.value = '';\r\n                self.ajaxing(false);\r\n                return;\r\n            }\r\n            const data = new FormData();\r\n            const content = self.checkMensions(self.textArea.value);\r\n            if(self.mensions.length){\r\n                data.append('mensions', self.mensions.join(','))\r\n            }\r\n            data.append('type', 'create')\r\n            data.append('x',self.marker.position.x)\r\n            data.append('y',self.marker.position.y)\r\n            data.append('el', self.marker.getElSelector())\r\n            data.append('content', content.trim())\r\n            data.append('post_id', window[Symbol.for('diviDesignNotesAPI')].data.post_id)\r\n            data.append('href', window[Symbol.for('diviDesignNotesAPI')].data.href)\r\n            data.append('title', window[Symbol.for('diviDesignNotesAPI')].data.title)\r\n            window[Symbol.for('diviDesignNotesAPI')].ajax(data)\r\n            .then(res=>{if(res.ok)return res.json()})\r\n            .then(obj => {\r\n                if(obj.success){\r\n                    self.clear();\r\n                    self.marker.reset();\r\n                    window[Symbol.for('diviDesignNotesAPI')].createNote(obj.html)\r\n                }\r\n                self.ajaxing(false);\r\n            }).catch(err =>{self.ajaxing(false)});\r\n            \r\n        },\r\n        ajaxing(flag = null){\r\n            if(flag === null){\r\n                return self.is_ajaxing;\r\n            }\r\n            if(flag){\r\n                self.element.classList.add('ajaxing');\r\n                self.is_ajaxing = true;\r\n            }\r\n            if(!flag){\r\n                self.element.classList.remove('ajaxing');\r\n                self.is_ajaxing = false;\r\n            }\r\n        },\r\n        init(){\r\n            self.textArea = self.element.querySelector('textarea');\r\n            document.body.appendChild(self.element);\r\n            on('click', self.clicked, self.element);\r\n        }\r\n\r\n        \r\n    };\r\n    self.init();\r\n    \r\n    return self;\r\n\r\n}","import shadowDropDown from \"./shadowDropDown\";\r\nimport { on, select } from \"./helpers\";\r\n\r\nexport default function shadowMarker( element ){\r\n    const self = {\r\n        element: element,\r\n        relatedElement: null,\r\n        relativeToElement: false,\r\n        dropDown: null,\r\n        active: false,\r\n        position: {\r\n            x:0,\r\n            y:0\r\n        },\r\n        getElSelector(){\r\n            return '.' + Array.from(self.relatedElement.classList).join('.');\r\n        },\r\n        pinOnPage( relatedElement,position ) {\r\n            self.position = position;\r\n            self.relatedElement = relatedElement;\r\n            self.active = true\r\n            self.element.classList.remove('active')\r\n            if(self.getRelativity()){\r\n                self.setRelPosition();\r\n            }else{\r\n                self.setFixPosition();\r\n            }\r\n            self.openClose();\r\n        },\r\n        setPosition(){\r\n            if(!self.active) return;\r\n            if(self.relativeToElement) return;  \r\n            self.setFixPosition();\r\n\r\n        },\r\n        getRelativity(){\r\n            self.relativeToElement = ['relative','absolute','fixed'].includes(getComputedStyle(self.relatedElement).position);\r\n            return self.relativeToElement;\r\n        },\r\n        setRelPosition(){\r\n            self.relatedElement.appendChild(self.element)\r\n            self.element.style.position = 'absolute';\r\n            self.element.style.top = `${(self.position.y/self.relatedElement.offsetHeight)*100}%`;\r\n            self.element.style.left = `${(self.position.x/self.relatedElement.offsetWidth)*100}%`;\r\n            self.element.style.transform = `translate(-20px,-40px)`;\r\n            // self.element.style.position = 'absolute';\r\n            // self.element.style.transform = `translate3d(${self.position.x}px,${self.position.y}px,0)`;\r\n        },\r\n        setFixPosition(){\r\n            const rects = self.relatedElement.getBoundingClientRect();\r\n            self.element.style.transform = `translate3d(${self.position.x + rects.x}px,${self.position.y+rects.y}px,0)`;\r\n        },\r\n        openClose(){\r\n            self.dropDown.openClose()\r\n        },\r\n        activate(element){\r\n            self.element.classList.add('active');\r\n            element.appendChild(self.element)\r\n        },\r\n        reset(){\r\n            self.relatedElement = null;\r\n            self.active = false;\r\n            self.dropDown.close();\r\n            self.element.style = '';\r\n            self.element.remove();\r\n        },\r\n        init(){\r\n            self.dropDown = shadowDropDown(self, select('#shadowdropdown'));\r\n            on('click', self.openClose, self.element);\r\n            return self;\r\n        },\r\n\r\n\r\n    };\r\n    \r\n    return self;\r\n}","import { select, on, off } from \"./helpers\";\r\n\r\nexport default function Menu(pageContainer){\r\n    const self = {\r\n        pageContainer: pageContainer,\r\n        element: select('#divi_design_notes_menu'),\r\n        moveButton:null,\r\n        toggleButton:null,\r\n        move(e){\r\n            // const x = self.element.style.left || 100;\r\n            // const y = self.element.style.top || 100;\r\n\r\n            self.element.style.transform = `translate3d(${e.clientX}px,${e.clientY}px,0)`;\r\n\r\n            // self.element.style.left = `${parseInt(x)+e.movementX}px`;\r\n            // self.element.style.top = `${parseInt(y)+e.movementY}px`;\r\n        },\r\n        stopMove(e){\r\n            off('mousemove', self.move);\r\n            off('mouseup', self.stopMove);\r\n            off('mouseleave',self.stopMove,self.element);\r\n            if(e.type === 'mouseleave'){\r\n                self.element.style.transform = '';\r\n            }\r\n        },\r\n        clicked(e){\r\n            if(!e.target.dataset.action){return}\r\n            const action = e.target.dataset.action;\r\n            if(action === 'toggle'){\r\n                self.element.classList.toggle('open')\r\n            }\r\n            if(action === 'new'){\r\n                window[Symbol.for('diviDesignNotesAPI')].buttonClicked(e)\r\n            }\r\n            \r\n        },\r\n        input(e){\r\n            if(e.target.id === 'resolved_notes'){\r\n                if(e.target.checked){\r\n                    document.body.classList.remove('hide-resolved');\r\n                }else{\r\n                    document.body.classList.add('hide-resolved');\r\n                }\r\n            }\r\n            if(e.target.id === 'active_notes'){\r\n                if(e.target.checked){\r\n                    document.body.classList.remove('hide-active');\r\n                }else{\r\n                    document.body.classList.add('hide-active');\r\n                }\r\n            }\r\n        },\r\n        init(){\r\n            self.moveButton = select('span[data-action=\"move\"]');\r\n\r\n            self.addButton = select('span[data-action=\"toggle\"]');\r\n            on('mousedown',()=>{\r\n                on('mousemove',self.move);\r\n                on('mouseup',self.stopMove);\r\n                on('mouseleave',self.stopMove,self.element);\r\n            },self.moveButton);\r\n\r\n            on('click',self.clicked,self.element)\r\n            on('input',self.input,self.element)\r\n        }\r\n    };\r\n    return self;\r\n}","import {select, on, off, renderElement} from './helpers.js';\r\nimport Marker from './marker';\r\nimport shadowMarker from './shadowMarker';\r\nimport Menu from './menu';\r\n\r\nexport default function DesignNotesMain(button, dataElement){\r\n    const self = {\r\n        button : select('#wp-admin-bar-design_notes'),\r\n        pageContainer: select('#page-container'),\r\n        templatesContainer: select('#design_notes_template'),\r\n\r\n        data : JSON.parse(select('#divi_design_notes_json').textContent),\r\n        notes: [],\r\n        menu: null,\r\n        hoveredElement : false,\r\n        user : '',\r\n        markerActive : false,\r\n        shadowMarker : null,\r\n        timeout : 0,\r\n        currenMatch : null,\r\n        inputTarget : null,\r\n        caret : null,\r\n        usersNode : document.createElement('ul'),\r\n        buttonClicked (e) {\r\n            e.preventDefault();\r\n            if(self.markerActive){\r\n                self.stopMarker();\r\n            }else{\r\n                self.startMarker();\r\n            }\r\n            return self;\r\n\r\n        },\r\n        startMarker() {\r\n            self.closeDropdowns();\r\n            self.shadowMarker.reset();\r\n            self.shadowMarker.activate(self.pageContainer);\r\n            on('mousemove', self.followMarker, self.pageContainer );\r\n            self.markerActive = true;\r\n            document.body.classList.add('marker-active');\r\n            on('click', self.markerClicked, self.pageContainer);\r\n        },\r\n        stopMarker() {\r\n            off('mousemove', self.followMarker, self.pageContainer );\r\n            self.shadowMarker.element.remove();\r\n            self.markerActive = false;\r\n            document.body.classList.remove('marker-active');\r\n            off('click', self.markerClicked, self.pageContainer);\r\n            if(self.hoveredElement) self.hoveredElement.style.outline = '';\r\n\r\n        },\r\n        followMarker(e) {\r\n            let module = e.target.matches('.et_pb_module') ? e.target : e.target.closest('.et_pb_module,.et_pb_row,.et_pb_section,header,#page-container');\r\n            if(module){\r\n                if(module !== self.hoveredElement){\r\n                    if(self.hoveredElement){\r\n                        self.hoveredElement.style.outline = '';\r\n                    }\r\n                    self.hoveredElement = module;\r\n                    self.hoveredElement.style.outline = '3px solid blue';\r\n                }\r\n            }else{\r\n                if(self.hoveredElement){\r\n                    self.hoveredElement.style.outline = '';\r\n                    self.hoveredElement = false;\r\n                }\r\n            }\r\n\r\n            self.shadowMarker.element.style.transform = `translate3d(${e.clientX}px,${e.clientY}px,0)`;\r\n        },\r\n        markerClicked (e) {\r\n            e.preventDefault();\r\n            off('mousemove', self.followMarker, self.pageContainer );\r\n            off('click', self.markerClicked, self.pageContainer);\r\n            const rects = self.hoveredElement.getBoundingClientRect();\r\n            const position = {\r\n                x: e.x -  rects.x,\r\n                y: e.y -  rects.y,\r\n            }\r\n            self.shadowMarker.pinOnPage(self.hoveredElement,position);\r\n            self.markerActive = false;\r\n            document.body.classList.remove('marker-active');\r\n            if(self.hoveredElement) self.hoveredElement.style.outline = '';\r\n        },\r\n        createNote(html){\r\n            const node = renderElement(html, self.templatesContainer,'afterbegin');\r\n            const newNote = Marker(node).init()\r\n            self.notes.push(newNote);\r\n            newNote.openClose()\r\n        },\r\n        inputHandler(e){\r\n            if(e.target.matches('.design_note_textarea')){\r\n                const input = self.inputTarget = e.target;\r\n                const textToCaret = input.value.substring(0, input.selectionStart);\r\n                const match = textToCaret.match(/@(?<text>[a-z]{0,3})$/i);\r\n                if(match){\r\n                    self.currenMatch = match;\r\n                    console.log(match)\r\n                    input.parentElement.appendChild(self.usersNode);\r\n                    if(match.groups.text){\r\n                        const usersMatched = self.data.users.filter(user => user.display_name.toLowerCase().includes(match.groups.text.toLowerCase()))\r\n                        self.usersNode.innerHTML = self.usersListItems(usersMatched)\r\n                    }else{\r\n                        self.usersNode.innerHTML = self.usersListItems(self.data.users)\r\n                    }\r\n                }else{\r\n                    self.usersNode.remove();\r\n                }\r\n            }\r\n        },\r\n        closeDropdowns(){\r\n            self.notes.forEach(marker=>{\r\n                marker.dropDown.close();\r\n            });\r\n            self.shadowMarker.dropDown.close();\r\n        },\r\n        chooseUser(e) {\r\n            const user = e.target;\r\n            const input = self.inputTarget;\r\n            const rejex = new RegExp(`${self.currenMatch[0]}$`,'g');\r\n            input.value = input.value.replace(rejex, `@${user.dataset.userName} `);\r\n            input.focus();\r\n            input.setSelectionRange(input.value.length + 1, input.value.length + 1);\r\n            self.usersNode.remove();\r\n        },\r\n        setPositions(){\r\n            self.notes.forEach((item) => {\r\n                item.setPosition();\r\n                item.dropDown.setPosition();\r\n            });\r\n            self.shadowMarker.setPosition();\r\n            self.shadowMarker.dropDown.setPosition();\r\n        },\r\n        maybeSetTimeout(e){\r\n            if(self.timeout){\r\n                clearTimeout(self.timeout);\r\n            }\r\n            self.timeout = setTimeout(()=>{\r\n                self.setPositions();\r\n                self.timeout = 0;\r\n            }, 100);\r\n        },\r\n        ajax(data){\r\n            data.append('action', 'divi_design_notes_ajax')\r\n            data.append('diviDesignNotesNonce', self.data.nonce)\r\n            return fetch(self.data.ajaxurl,{\r\n                method: 'POST',\r\n                body: data\r\n            })\r\n        },\r\n        setMarkers(){\r\n            const selectedMarkers = select('[id^=notemarker]', self.templatesContainer, true);\r\n            selectedMarkers.forEach(node => {\r\n                self.notes.push(Marker(node).init());\r\n                return;\r\n            });\r\n        },\r\n        delete($marker){\r\n            $marker.dropDown.element.remove();\r\n            $marker.element.remove();\r\n            self.notes.splice(self.notes.indexOf($marker),1);\r\n        },\r\n        usersListItems(list){\r\n            return html = list.map(user => {\r\n                return `<li data-user-name=\"${user.display_name}\">${user.display_name}<span>${user.user_email}</span></li>`;\r\n            }).join('');\r\n        },\r\n        init(){\r\n            if( self.markerActive ){\r\n                self.stopMarker()\r\n            }\r\n            if(self.menu){return;}\r\n            //Menu\r\n            self.menu = Menu(self.pageContainer);\r\n            self.menu.init();\r\n            //Users related\r\n            self.usersNode.id = 'design_notes_user_list';\r\n            self.usersNode.innerHTML = self.usersListItems(self.data.users)\r\n            // self.data.users.forEach(item =>{\r\n            //     const li = document.createElement('li');\r\n            //     li.dataset.userId = item.id;\r\n            //     li.dataset.userName = item.display_name;\r\n            //     li.textContent = item.display_name;\r\n            //     self.usersNode.appendChild(li);\r\n            // });\r\n            //Set Markers\r\n            const selectedMarkers = select('[id^=notemarker]', self.templatesContainer, true);\r\n            selectedMarkers.forEach(node => {\r\n                self.notes.push(Marker(node).init());\r\n                return;\r\n            });\r\n            //ShadowMarker\r\n            const elem =  select('#shadowmarker', self.templatesContainer);\r\n            self.shadowMarker = shadowMarker(elem).init();\r\n\r\n            on('click', self.chooseUser, self.usersNode);\r\n            //on('click', self.buttonClicked, self.button);\r\n            on('scroll', self.maybeSetTimeout);\r\n            on('resize', self.maybeSetTimeout, window);\r\n            on('input', self.inputHandler);\r\n            on('transitionend', self.maybeSetTimeout, self.pageContainer);\r\n\r\n        },\r\n        \r\n    };\r\n   \r\n\r\n    return self;\r\n}","import DesignNotesMain from './designNotesMain.js'\r\nimport DesignNote from './designNote.js'\r\nimport Marker from './marker'\r\nimport {on, select} from './helpers.js'\r\nwindow.addEventListener('load', function(){\r\n\r\n    const button = select('#wp-admin-bar-design_notes');\r\n    if(button){\r\n        on('click', function(){\r\n            document.body.classList.toggle('show_design_notes');\r\n            window[Symbol.for('diviDesignNotesAPI')].init();\r\n        },button)\r\n    }\r\n\r\n    window[Symbol.for('diviDesignNotesAPI')] = DesignNotesMain();\r\n\r\n});\r\n"],"names":["$9da41f4cb74fe07e$export$af631764ddc44097","event","callback","element","document","addEventListener","$9da41f4cb74fe07e$export$8c8705df4a2dcec9","removeEventListener","$9da41f4cb74fe07e$export$2e6c959c16ff56b8","selector","all","querySelectorAll","querySelector","$9da41f4cb74fe07e$export$d544df0d2baa9f2c","parent","position","property","insertAdjacentHTML","$c5e9ed3635a9e4c8$export$2e2bcd8739ae039","marker","self","active","textArea","is_ajaxing","mensions","openClose","close","open","window","Symbol","for","closeDropdowns","classList","add","setPosition","remove","checkMensions","string","stringMensions","data","users","forEach","user","includes","display_name","replace","indexOf","user_email","push","rects","getBoundingClientRect","fromLeft","x","fromRight","innerWidth","right","fromBottom","innerHeight","bottom","translate","style","top","left","transform","maxHeight","clicked","e","target","dataset","action","ajaxing","delete","post","resolve","FormData","append","id","ajax","then","res","ok","json","catch","err","value","trim","content","length","join","post_id","href","title","obj","success","html","flag","init","body","appendChild","$b1fd6c0a5aaba866$export$2e2bcd8739ae039","split","JSON","parse","params","relatedElement","relativeToElement","dropDown","y","getRelativity","getComputedStyle","setRelPosition","offsetHeight","offsetWidth","setFixPosition","el","pos","$6352ba5d4a36b227$export$2e2bcd8739ae039","clear","reset","create","getElSelector","createNote","$f9eeee45ab1941f0$export$2e2bcd8739ae039","Array","from","pinOnPage","activate","$d1520a3df2ffa73d$export$2e2bcd8739ae039","pageContainer","moveButton","toggleButton","move","clientX","clientY","stopMove","type","toggle","buttonClicked","input","checked","addButton","$c5d2c78fe0887249$export$2e2bcd8739ae039","button","dataElement","templatesContainer","textContent","notes","menu","hoveredElement","markerActive","shadowMarker","timeout","currenMatch","inputTarget","caret","usersNode","createElement","preventDefault","stopMarker","startMarker","followMarker","markerClicked","outline","module","matches","closest","html1","newNote","inputHandler","match","substring","selectionStart","console","log","parentElement","groups","text","usersMatched","filter","toLowerCase","innerHTML","usersListItems","chooseUser","rejex","RegExp","userName","focus","setSelectionRange","setPositions","item","maybeSetTimeout","clearTimeout","setTimeout","nonce","fetch","ajaxurl","method","setMarkers","node","$marker","splice","list","map","elem"],"version":3,"file":"main.js.map"}